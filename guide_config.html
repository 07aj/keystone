---
permalink: /guide/config/
---
<!DOCTYPE html><html><head><script>var _sf_startpt=(new Date()).getTime()</script><meta charset="utf-8"><meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width"><title>KeystoneJS &middot; KeystoneJS Configuration Options</title><link href="/styles/site.min.css" rel="stylesheet"><link href="/styles/prism.css" rel="stylesheet"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"></head><body><header role="banner" id="docs-header"><div class="container"><a href="/" title="KeystoneJS" class="keystone-logo"><img src="/images/logo.svg" alt="KeystoneJS" width="207" height="70"></a><div class="social-buttons hidden-xs"><a href="https://twitter.com/keystonejs" data-show-count="false" class="twitter-follow-button">Follow @keystonejs</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><iframe src="http://ghbtns.com/github-btn.html?user=JedWatson&amp;repo=keystone&amp;type=watch&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="80" height="20"></iframe></div></div></header><nav id="docs-nav"><div class="container"><ul class="nav navbar-nav"><li><a href="/">Home</a></li><li><a href="/guide">Getting Started</a></li><li class="active"><a href="/guide/config">Configuration</a></li><li><a href="/guide/data">Database</a></li><li><a href="/examples">Examples</a></li></ul></div></nav><div id="docs-body"><div class="container"><div class="alerts"><div class="alert alert-success">The KeystoneJS docs are in beta. For updates, please follow @keystonejs on twitter!</div></div></div><div class="container"><div class="row"><div class="col-sm-3"><div id="docs-sidebar"><ul class="sidebar-nav"><li class="nav-label">Keystone Options</li><li><a href="#concepts">Setting Options</a></li><li><a href="#project">Project Options</a></li><li><a href="#server">Web Server Options</a></li><li><a href="#database">Database and User Auth Options</a></li><li class="nav-label">Services</li><li><a href="#cloudinary">Cloudinary</a></li><li><a href="#google">Google Maps</a></li><li><a href="#embedly">Embed.ly</a></li><li class="nav-label">More</li><li><a href="#updates">Application Updates</a></li><li><a href="#headless">Disabling the Admin UI</a></li></ul></div></div><div class="col-sm-9"><div id="docs-content"><a name="concepts"></a><h1>Keystone Options</h1><p>The options for KeystoneJS cover a range of behaviours, from how the express app is configured, to enabling features and authentication options for integrated services.</p><p>There are three ways to set options:</p><ul class="options"><li>Passing a <code>{ key: 'value' }</code> configuration <code class="data-type">Object</code> to the <code>keystone.init(options)</code> method</li><li>Calling <code>keystone.set('key', 'value')</code></li><li>Setting environment variables in <code>process.env</code>. Only some options support this (noted below).</li></ul><p>If you want to keep secret keys and configuration out of your codebase (especially important for open source projects, or projects where not all developers should have access to production config settings) the <a href="https://npmjs.org/package/dotenv" target="_blank">dotenv</a> module makes this very easy to manage.</p><a name="project"></a><h2>Project Options</h2><p>The following options control the branding and navigation of the KeystoneJS application in the Admin UI:</p><table class="table"><col width="210"><col><tr><td><code>name</code> <code class="data-type">String</code></td><td>The name of the KeystoneJS application</td></tr><tr><td><code>brand</code> <code class="data-type">String</code></td><td>Displayed in the top left hand corner of the Admin UI</td></tr><tr><td><code>nav</code> <code class="data-type">Object</code></td><td><p>An object that specifies the navigation structure for the Admin UI. Create a key for each section that should be visible in the primary navigation. Each key's value can be a single list path (as is seen in the URL when you view a list) or an array of list paths. When an array is used, secondary navigation is rendered in the Admin UI.</p><p>The nav is also used to generate the links on the Admin UI home page; any lists that are registered but not included in the <code>nav</code> will be grouped at the bottom of the screen under the 'Other' heading.</p></td></tr></table><div class="code-header"><h4>Custom Navigation Example</h4><p>If you had <code>User</code>, <code>Post</code> and <code>PostCategory</code> models, you could group the posts and post categories into a <strong>Content</strong> navigation item like this:</p></div><pre><code class="language-javascript">keystone.set('nav', {
    'users': 'users',
    'content': ['posts', 'post-categories']
});</code></pre><a name="server"></a><h2>Web Server Options</h2><p>The following options control the configuration of your web server and the express app:</p><table class="table"><col width="210"><col><tr><td><code>env</code> <code class="data-type">String</code></td><td><p>The environment setting to use. The keys <strong>development</strong> and <strong>production</strong> are supported, and this will have an impact on things like caching compiled templates. Defaults to <code class="default-value">process.env.NODE_ENV || "development"</code>.</p><p>It's strongly recommended you set this to 'production' for your production servers using the <code>NODE_ENV</code> environment variable, as several other modules also expect this convention.</p></td></tr><tr><td><code>port</code> <code class="data-type">Number</code></td><td><p>The port to listen for request on. Defaults to <code class="default-value">process.env.PORT || 3000</code></p></td></tr><tr><td><code>views</code> <code class="data-type">String</code></td><td><p>The path to your application's <strong>view templates</strong>. This is required for using the <code>keystone.View</code> Class, and will also be set on the express app.</p><p>If you're following the <a href="/guide#start_structure">recommended project structure</a>, this should be set to <code class="default-value">"/templates/views"</code>.</p></td></tr><tr><td><code>view engine</code> <code class="data-type">String</code></td><td><p>The template engine to use by default. Any engine with express support should work. <strong>Jade</strong> is included with Keystone, but you will have to add any alternate engine to your project's dependencies in your <code>package.json</code>.</p><p>This option is set on the express app (<a href="http://expressjs.com/api.html#app.engine" target="_blank">see docs here</a>).</p></td></tr><tr><td><code>locals</code> <code class="data-type">Object</code></td><td><p>The default local variables to pass to your view templates.</p><p>Routes can extend or change local variables by modifying <code>res.locals</code>.</p></td></tr><tr><td><code>static</code> <code class="data-type">String</code></td><td><p>The path to your application's static files. Setting this will include the <code>express.static</code> middleware.</p><p>If you're following the <a href="/guide#start_structure">recommended project structure</a>, this should be set to <code class="default-value">"/public"</code>.</p></td></tr><tr><td><code>less</code> <code class="data-type">String</code></td><td><p>If you want Keystone to automatically compile <strong>.less</strong> files into <strong>.css</strong> files, set this value to the same path as the <code>static</code> option.</p><p>When this option is set, any requests to a <strong>.css</strong> or <strong>.min.css</strong> file will first check for a <strong>.less</strong> file with the same name, and if one is found, the css file will be regenerated.</p></td></tr><tr><td><code>favicon</code> <code class="data-type">String</code></td><td><p>The path to your application's <strong>favicon</strong>. Setting this will include the <code>express.favicon</code> middleware. Should be relative to your project's root.</p><p>If you're following the <a href="/guide#start_structure">recommended project structure</a>, this should be set to <code class="default-value">"/public/favicon.ico"</code>.</p></td></tr><tr><td><code>compress</code> <code class="data-type">Boolean</code></td><td>Set this to <code class="default-value">true</code> to enable HTTP compression. This will include the <code>express.compress</code> middleware (<a href="http://expressjs.com/api.html#compress" target="_blank">see docs here</a>).</td></tr><tr><td><code>logger</code> <code class="data-type">String</code></td><td>Set this to include the <code>express.logger</code> middleware. The value will be passed to the middleware initialisation (<a href="http://www.senchalabs.org/connect/logger.html" target="_blank">see docs here</a>).</td></tr></table><a name="database"></a><h2>Database and User Auth Options</h2><p>The following options control your database configuration and user models / authentication:</p><table class="table"><col width="210"><col><tr><td><code>mongo</code> <code class="data-type">String</code></td><td><p>The url for your MongoDB connection.</p><p>You should typically set this to <code class="default-value">"mongodb://localhost/your-db" || process.env.MONGO_URI</code></p></td></tr><tr><td><code>auth</code> <code class="data-type">Mixed</code></td><td><p>Whether to enable built-in auth for Keystone's Admin UI, or a custom function to use to authenticate users.</p><p>When this is set to <code class="default-value">false</code> (or not defined), Keystone's Admin UI will be open to the public (so set it!)</p><p>If using a custom function, it should follow the standard for express middleware of <code>function(req, res, next)</code>. If a user is not logged in or should not access Keystone's Admin UI, use <code>res.redirect()</code> to redirect them - otherwise call the <code>next</code> callback to enable access.</p></td></tr><tr><td><code>user model</code> <code class="data-type">String</code></td><td><p>The key of the Keystone List for users, <strong>required</strong> if <code>auth</code> is set to <code class="default-value">true</code></p><p>Typically this would be set to <code class="default-value">User</code>.</p></td></tr><tr><td><code>cookie secret</code> <code class="data-type">String</code></td><td><p>The encryption key to use for your cookies. Passed to Express's cookie parser.</p><p>It's a really good idea to set this to a long, random string.</p></td></tr><tr><td><code>signout</code> <code class="data-type">String</code></td><td><p><code>href</code> for the signout link in the top right of the UI</p><p>Defaults to <code class="default-value">/keystone/signout</code> if <code>auth</code> is set to <code class="default-value">true</code></p></td></tr></table><p>For a walk-through of how to set these options up, see the <a href="/guide#models_auth">getting started guide</a>.</p><p>For more information about setting up and using database models with Keystone, see the <a href="/guide/data">database guide</a>.</p><h2>Services</h2><a name="google"></a><h3>Google Maps</h3><p>Keystone's <a href="/guide/data#field_location">Location field type</a> supports integration with the <a href="http://www.morethanamap.com" target="_blank">Google Maps API</a> to auto-improve values (including discovering latitude and longitude) via the <a href="https://developers.google.com/places/documentation/autocomplete" target="_blank"> Places Autocomplete API</a>.</p><p>To enable these features, <a href="https://code.google.com/apis/console/" target"_blank">obtain an API Key from Google</a> and enable the Google Maps v3 and Google Places APIs for it, then set the following options:</p><table class="table"><col width="270"><col><tr><td><code>google api key</code> <code class="data-type">String</code></td><td><p>Your Google API browser key, used to authenticate the Javascript Maps API in the Admin UI.</p><p>Will default to <code class="default-value">process.env.GOOGLE_BROWSER_KEY</code></p></td></tr><tr><td><code>google server api key</code> <code class="data-type">String</code></td><td><p>Your Google API server key, used to authenticate requests to the Maps API from the server.</p><p>Will default to <code class="default-value">process.env.GOOGLE_SERVER_KEY</code></p></td></tr><tr><td><code>default region</code> <code class="data-type">String</code> </td><td><p><strong>Optional</strong> setting to limit autocomplete results to a specific region.</p><p>This option takes a region code, specified as a <a href="http://www.iana.org/assignments/language-subtag-registry/language-subtag-registry" target="_blank">IANA language region</a> subtag.</p><p>Can be specified on a per-field basis by setting the <code>region</code> option on any <code>Location</code> field.</p></td></tr></table><pre><code class="language-javascript">keystone.set('google api key', 'your-browser-key');
keystone.set('google server api key', 'your-server-key');
keystone.set('default region', 'au'); // optional, will limit autocomplete results to Australia</code></pre><p class="note">Note that the use of the Places Geocoding API is subject to a query limit of 2,500 geolocation requests per day, except with an enterprise license.</p><p class="note">The Places Geocoding API may only be used in conjunction with a Google map; geocoding results without displaying them on a map is prohibited. Please make sure your Keystone app complies with the Google Maps API License.</p><a name="cloudinary"></a><h3>Cloudinary</h3><p><a href="http://cloudinary.com" target="_blank">Cloudinary</a> is an image upload / resizing / hosting service that makes it easy to implement image management in your KeystoneJS app using the <a href="/guide/data#field_cloudinaryimage">CloudinaryImage</a> and <a href="/guide/data#field_cloudinaryimages">CloudinaryImages</a> field types.</p><p>To use the Cloudinary Image fields in your app, <a href="https://cloudinary.com/users/register/free" target="_blank">sign up for an account</a> (Cloudinary offers a free tier with up to 500MB storage, 50,000 images and 1GB data transfer) and get your <strong>cloud name</strong>, <strong>api key</strong> and <strong>api secret</strong>.</p><p>Then set the <code>cloudinary config</code> option to<ul><li>an object containing your configuration (see example below), or</li><li>the environment variable string Cloudinary gives you (e.g. <code class="default-value">cloudinary://api_key:api_secret@cloud_name</code>)</li></ul></p><p>This option will default to the <code class="default-value">CLOUDINARY_URL</code> environment variable if it is set.</p><p>When images are uploaded to Cloudinary via the Admin UI or field methods, they will have some tags automatically set on them. To prefix these tags with a custom string, set the <code>cloudinary prefix</code> option.</p><p>The built-in tags that are automatically set include:<ul><li><code class="default-value">{list.path}_{field.path}</code></li><li><code class="default-value">{list.path}_{field.path}_{item.id}</code></li><li><code class="default-value">{prefix}</code> (if set)</li><li><code class="default-value">dev</code> (if the <code>env</code> option is not set to <code class="default-value">production</code>)</li></ul></p><pre><code class="language-javascript">keystone.set('cloudinary config', { cloud_name: 'my-cloud', api_key: 'abc', api_secret: '123' });
// or 
keystone.set('cloudinary config', 'cloudinary://api_key:api_secret@cloud_name' );
 
// optional, will prefix all built-in tags with 'keystone_'
keystone.set('cloudinary prefix', 'keystone');</code></pre><a name="embedly"></a><h3>Embed.ly</h3><p><a href="http://embed.ly" target="_blank">Embed.ly</a> is a service that will parse a url (e.g. Youtube embed link) and return a whole lot of useful information, like the provider name, summary metadata, width and height of videos, as well as a clean link to use for embedding media in your views. They offer a free plan for up to 5,000 urls per month.</p><p>The <a href="/guide/data#field_embedly">Embedly field type</a> is an easy way to integrate their API with your KeystoneJS app.</p><p>To configure KeystoneJS to support the Embed.ly API, simply <a href="https://app.embed.ly/signup">sign up for an account</a>, get your api key, and set the <code>embedly api key</code> option.</p><p>This option will default to the <code class="default-value">EMBEDLY_API_KEY</code> environment variable if it is set.</p><pre><code class="language-javascript">keystone.set('embedly api key', 'your-key');</code></pre><a name="updates"></a><h2>Application Updates</h2><p>Keystone includes an updates framework, which you can enable by setting the <code>auto update</code> option to <code class="default-value">true</code>.</p><p>Updates provide an easy way to seed your database, transition data when your models change, or run transformation scripts against your database.</p><p>Update files should be named using a semantic version followed by an optional key, like <code>0.0.1-init.js</code>. The version numbers are used to order the update scripts correctly, while the keys are a nice way to identify what each update does.</p><p>Each update file should export a single function, which should accept a single argument - the <code>next(err)</code> callback, to be called when the update is complete.</p><p>All the update files will be executed (each one waits for the previous update to complete) before the web server is started.</p><p>If the <code>next</code> callback is receives an error it will be reported to the console, and application initialisation will halt.</p><p>You can temporarily disable updates from running in development by setting a <code>__defer__</code> property on the exported function to <code>true</code>. Any subsequent updates will be skipped, but the application will be started.</p><p>Updates are only run once, and each completed update is logged in an <code>app_updates</code> collection in your database.</p><div class="code-header"><h4>Update Script Example</h4><p>Creates a new admin User</p></div><pre><code class="language-javascript">var keystone = require('keystone'),
    User = keystone.list('User');
 
exports = module.exports = function(done) {
    new User.model({
        name: { first: 'Admin', last: 'User' },
        password: 'admin',
        isAdmin: true
    }).save(done);
};</code></pre><a name="headless"></a><h2>Disabling the Admin UI</h2><p>You can disable the Admin UI by setting the <code>headless</code> option to <code class="default-value">false</code>.</p><p>This will allow you to use <code>keystone.start()</code> or <code>keystone.routes(app)</code> without Keystone creating route bindings for the Admin UI routes under <code class="default-value">/keystone</code>.</p></div></div></div></div></div><div id="docs-footer"><div class="container"><div class="social-buttons"><div class="social-button"><a href="https://twitter.com/keystonejs" data-show-count="false" class="twitter-follow-button">Follow @keystonejs</a></div><div class="social-button"><iframe src="http://ghbtns.com/github-btn.html?user=JedWatson&amp;repo=keystone&amp;type=watch&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="80" height="20"></iframe></div></div><div class="footer-wrap"><ul class="list-links"><li><a href="https://github.com/JedWatson/keystone" target="_blank" title="Github Project">Github Project</a></li><li><a href="http://demo.keystonejs.com" target="_blank" title="Demo Website">Demo Website</a></li><li><a href="/guide" title="KeystoneJS Getting Started">Getting Started Guide</a></li><li><a href="/guide/config" title="KeystoneJS Configuration">Configuration Guide</a></li><li><a href="/guide/data" title="KeystoneJS Database">Database Guide</a></li><li><a href="/examples" title="KeystoneJS Database">Example Applications</a></li></ul><p class="copyright">&copy; 2013 Jed Watson</p></div></div></div><script src="/js/lib/jquery/jquery-1.10.2.min.js"></script><script src="/js/lib/bootstrap/collapse.js"></script><script src="/js/lib/bootstrap/dropdown.js"></script><script src="/js/lib/prism/prism.min.js"></script><script>if (window.location.hostname.match(/keystonejs\.com/)) {
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
 
 ga('create', 'UA-43970386-1', 'keystonejs.com');
 ga('send', 'pageview');
}</script><script>if (window.location.hostname.match(/keystonejs\.com/)) {
 var _sf_async_config = { uid: 46610, domain: 'keystonejs.com', useCanonical: true };
 (function() {
  function loadChartbeat() {
   window._sf_endpt = (new Date()).getTime();
   var e = document.createElement('script');
   e.setAttribute('language', 'javascript');
   e.setAttribute('type', 'text/javascript');
   e.setAttribute('src','//static.chartbeat.com/js/chartbeat.js');
   document.body.appendChild(e);
  };
  var oldonload = window.onload;
  window.onload = (typeof window.onload != 'function') ?
  loadChartbeat : function() { oldonload(); loadChartbeat(); };
 })();
}
</script></body></html>